Checking Metal GPU...
  Device: Metal.MTL.MTLDeviceInstance (object of type AGXG14CDevice)
Precomputing lines...
  Lines: 5524 | Packed points: 21228 | Max len: 19 | Triple-equiv: 83640 | 0.012s
  Collinearity normalization: mean-incidence | incidence mean=695.069, min=568.000, max=980.000
Coefficient selection:
  mode=normalized | base α=10.000, γ=4.000
  normalized mode active with col-normalization=mean-incidence
  overrides applied -> α=15.000, γ=4.000
============================================================
N3L Gradient Flow — Metal GPU (Line-Based RK4 Kernel v3)
============================================================
n=19, target=38 | α=15.000, β=1.0, γ=4.000
Max: 5000 traj, T=10.000s (effective 10.000s), dt=0.0050, steps=2000
Batch size: 1024 | Seed: 17035358442214782339
------------------------------------------------------------
Lines: 5524 | Packed points: 21228 | max line len: 19 | triple-equivalent terms: 83640
Collinearity normalization: mean-incidence
State dim: 361
------------------------------------------------------------
Warming up Metal GPU (compiling kernel)...
  ✓ Metal warmup OK
------------------------------------------------------------
[Batch 1/5] Launching 1024 trajectories on GPU...
  Best violations: 32 | 1024 tried | 11.2 traj/s
[Batch 2/5] Launching 1024 trajectories on GPU...
  Best violations: 32 | 2048 tried | 11.2 traj/s
[Batch 3/5] Launching 1024 trajectories on GPU...
